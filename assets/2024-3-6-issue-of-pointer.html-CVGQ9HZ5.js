import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as s,c as a,e as t}from"./app-CFAw5jJ9.js";const p={},o=t(`<p>我们用了一个我们认为安全的复制方法，绕过Copy Trait实现了向量内元素的移动。然而它真的安全吗？</p><p>在插入排序的单元测试里加入这么一个用例：</p><div class="language-rust line-numbers-mode" data-ext="rs" data-title="rs"><pre class="language-rust"><code><span class="token attribute attr-name">#[test]</span>
<span class="token keyword">fn</span> <span class="token function-definition function">it_struct_sort_ascending_equal_box</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token attribute attr-name">#[derive(Debug, PartialEq)]</span>
    <span class="token keyword">struct</span> <span class="token type-definition class-name">Foo</span> <span class="token punctuation">{</span>
        id<span class="token punctuation">:</span> <span class="token keyword">u32</span><span class="token punctuation">,</span>
        name<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">&#39;static</span> <span class="token keyword">str</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">let</span> <span class="token keyword">mut</span> v <span class="token operator">=</span> <span class="token macro property">vec!</span><span class="token punctuation">[</span>
        <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Foo</span> <span class="token punctuation">{</span>
            id<span class="token punctuation">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
            name<span class="token punctuation">:</span> <span class="token string">&quot;ZS&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Foo</span> <span class="token punctuation">{</span>
            id<span class="token punctuation">:</span> <span class="token number">43</span><span class="token punctuation">,</span>
            name<span class="token punctuation">:</span> <span class="token string">&quot;LS&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Foo</span> <span class="token punctuation">{</span>
            id<span class="token punctuation">:</span> <span class="token number">145</span><span class="token punctuation">,</span>
            name<span class="token punctuation">:</span> <span class="token string">&quot;WW&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Foo</span> <span class="token punctuation">{</span>
            id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
            name<span class="token punctuation">:</span> <span class="token string">&quot;ZL&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Foo</span> <span class="token punctuation">{</span>
            id<span class="token punctuation">:</span> <span class="token number">9</span><span class="token punctuation">,</span>
            name<span class="token punctuation">:</span> <span class="token string">&quot;SQ&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Foo</span> <span class="token punctuation">{</span>
            id<span class="token punctuation">:</span> <span class="token number">43</span><span class="token punctuation">,</span>
            name<span class="token punctuation">:</span> <span class="token string">&quot;LS2&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token class-name">InsertionSorter</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> v<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort_by</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>prev<span class="token punctuation">,</span> next<span class="token closure-punctuation punctuation">|</span></span> prev<span class="token punctuation">.</span>id <span class="token operator">&lt;=</span> next<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">assert_eq!</span><span class="token punctuation">(</span>
        v<span class="token punctuation">,</span>
        <span class="token macro property">vec!</span><span class="token punctuation">[</span>
            <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Foo</span> <span class="token punctuation">{</span>
                id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                name<span class="token punctuation">:</span> <span class="token string">&quot;ZL&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Foo</span> <span class="token punctuation">{</span>
                id<span class="token punctuation">:</span> <span class="token number">9</span><span class="token punctuation">,</span>
                name<span class="token punctuation">:</span> <span class="token string">&quot;SQ&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Foo</span> <span class="token punctuation">{</span>
                id<span class="token punctuation">:</span> <span class="token number">22</span><span class="token punctuation">,</span>
                name<span class="token punctuation">:</span> <span class="token string">&quot;ZS&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Foo</span> <span class="token punctuation">{</span>
                id<span class="token punctuation">:</span> <span class="token number">43</span><span class="token punctuation">,</span>
                name<span class="token punctuation">:</span> <span class="token string">&quot;LS&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Foo</span> <span class="token punctuation">{</span>
                id<span class="token punctuation">:</span> <span class="token number">43</span><span class="token punctuation">,</span>
                name<span class="token punctuation">:</span> <span class="token string">&quot;LS2&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token class-name">Box</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">Foo</span> <span class="token punctuation">{</span>
                id<span class="token punctuation">:</span> <span class="token number">145</span><span class="token punctuation">,</span>
                name<span class="token punctuation">:</span> <span class="token string">&quot;WW&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>执行发现报错了，它甚至无法正常输出错误信息，断点调试直接跳到汇编去了。我也不是很懂汇编，那就在报错前看看调试器监测的数据吧。</p><p>可以看到在函数执行到</p><div class="language-rust line-numbers-mode" data-ext="rs" data-title="rs"><pre class="language-rust"><code>vec<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这一句之后，<code>e</code>和<code>vec[1]</code>都变成了错误的数据（一个很大的id），此时e仍然能被监测到，到下一个循环时e按理说就被释放掉了。 而到下一次<code>vec[j] = e</code>时崩溃了。</p><p>我们现在把<code>vec[j] = e</code>换成下面的，再调试一下：</p><div class="language-rust line-numbers-mode" data-ext="rs" data-title="rs"><pre class="language-rust"><code><span class="token namespace">ptr<span class="token punctuation">::</span></span><span class="token function">copy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>e<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> vec<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这次调试的运行情况比之前有一些细微的变化。</p><p>这一句之后，<code>e</code>和<code>vec[1]</code>还是正确的数，而到结束这个循环到下一个循环时，<code>e</code>不再被监测得到，同时<code>vec[1]</code>的值才在这时候变成了错误的值。 而且看<code>e</code>的类型，是个<code>Foo *</code>，也就是<code>Box&lt;Foo&gt;</code>，可以猜测，是在e脱离作用域后，被释放掉了，这不是浅层地释放掉Box指针而已， 而是层层调用释放函数，将资源释放掉。</p><p><code>e</code>是被拷贝出来的，所有权也在本函数内，即使再放回（以copy的方式）原位，数组没有变化，也会因为<code>e</code>和<code>vec[1]</code>两个指针指向同一个数据，<code>e</code>被释放掉导致<code>vec[1]</code>悬垂了。</p><p>再对比之前的运行，执行<code>vec[j] = e</code>之后，e的所有权被移交出去了，而在所有权移交的同时，数据发生了改变。</p><blockquote><p>第一个循环，vec[1] --&gt; e vec[0] &lt; e，e维持原位，重新赋值回vec[1] vec[1]数据出错（被释放了，并强行读取了数据），id是一个很大的数</p></blockquote><p>注意<code>e</code>是拷贝出来的，也就是<code>vec[1]</code>也是一个有所有权的数据。<code>e</code>移动到<code>vec[1]</code>，就意味着<code>vec[1]</code>原本存放的数据没人要了（显然也没有任何办法可以索引到了），没人要的数据会立即结束声明周期，就地释放。</p><p>而又因为被释放的数据和<code>e</code>以及<code>vec[1]</code>是同一个指针，导致<code>e</code>和<code>vec[1]</code>都悬垂了。到了下一个循环时，当被复制出来的数据要再次替换vec某个位置的数据时， 这个数据再次被替换了出去，触发了已释放的空间重复释放，导致程序崩溃。</p><blockquote><p>第二个循环，vec[2] --&gt; e vec[1] &gt; e，vec[1] --&gt; vec[2] vec[0] &lt; e, 尝试e --&gt; vec[1] vec[1]已经被释放，再次释放，程序崩溃</p></blockquote><p>这里还有一个需要注意的点，就是移动的意义。可以看出移动也是复制，<code>e</code>和<code>vec[1]</code>同时悬垂也意味着两者存的是同一个指针。 那么这种移动在一般的安全实现中，移出方结束生命周期，为什么接受方并没有悬垂呢？这正是因为移出的数据已经标记为不拥有所有权， 所以这个变量在结束生命周期时，不会执行释放，仅销毁变量本身所保存的值（比如指针）。</p><p>那么e是被强制复制出来的，现在同时存在两个指向同一个资源的指针，我们要做的就是防止其中一个指针在声明周期结束时释放资源。 也就是说，手动把一个变量标记为“已移出”。正好，Rust的<code>mem::forget()</code>就是干这个的。</p><p>所以在</p><div class="language-rust line-numbers-mode" data-ext="rs" data-title="rs"><pre class="language-rust"><code><span class="token namespace">ptr<span class="token punctuation">::</span></span><span class="token function">copy</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>e<span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token keyword">mut</span> vec<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>的后面，加上</p><div class="language-rust line-numbers-mode" data-ext="rs" data-title="rs"><pre class="language-rust"><code><span class="token namespace">mem<span class="token punctuation">::</span></span><span class="token function">forget</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>这个问题就解决了。</p>`,24),e=[o];function c(u,l){return s(),a("div",null,e)}const r=n(p,[["render",c],["__file","2024-3-6-issue-of-pointer.html.vue"]]),d=JSON.parse(`{"path":"/posts/2024-3-6-issue-of-pointer.html","title":"Rust与算法基础（4++）：你以为的安全真的安全吗？","lang":"zh-CN","frontmatter":{"title":"Rust与算法基础（4++）：你以为的安全真的安全吗？","date":"2024-03-06T00:00:00.000Z","category":"编程","tag":["Rust","算法"],"description":"我们用了一个我们认为安全的复制方法，绕过Copy Trait实现了向量内元素的移动。然而它真的安全吗？ 在插入排序的单元测试里加入这么一个用例： 执行发现报错了，它甚至无法正常输出错误信息，断点调试直接跳到汇编去了。我也不是很懂汇编，那就在报错前看看调试器监测的数据吧。 可以看到在函数执行到 这一句之后，e和vec[1]都变成了错误的数据（一个很大的i...","head":[["meta",{"property":"og:url","content":"https://qt911025.github.io/posts/2024-3-6-issue-of-pointer.html"}],["meta",{"property":"og:site_name","content":"QuenTine的博客"}],["meta",{"property":"og:title","content":"Rust与算法基础（4++）：你以为的安全真的安全吗？"}],["meta",{"property":"og:description","content":"我们用了一个我们认为安全的复制方法，绕过Copy Trait实现了向量内元素的移动。然而它真的安全吗？ 在插入排序的单元测试里加入这么一个用例： 执行发现报错了，它甚至无法正常输出错误信息，断点调试直接跳到汇编去了。我也不是很懂汇编，那就在报错前看看调试器监测的数据吧。 可以看到在函数执行到 这一句之后，e和vec[1]都变成了错误的数据（一个很大的i..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-03-06T15:16:25.000Z"}],["meta",{"property":"article:author","content":"QuenTine"}],["meta",{"property":"article:tag","content":"Rust"}],["meta",{"property":"article:tag","content":"算法"}],["meta",{"property":"article:published_time","content":"2024-03-06T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-03-06T15:16:25.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Rust与算法基础（4++）：你以为的安全真的安全吗？\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-03-06T00:00:00.000Z\\",\\"dateModified\\":\\"2024-03-06T15:16:25.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"QuenTine\\",\\"url\\":\\"https://qt911025.github.io\\"}]}"]]},"headers":[],"git":{"createdTime":1709738185000,"updatedTime":1709738185000,"contributors":[{"name":"qt911025","email":"qt911025@qq.com","commits":1}]},"readingTime":{"minutes":3.77,"words":1131},"filePathRelative":"posts/2024-3-6-issue-of-pointer.md","localizedDate":"2024年3月6日","excerpt":"<p>我们用了一个我们认为安全的复制方法，绕过Copy Trait实现了向量内元素的移动。然而它真的安全吗？</p>\\n<p>在插入排序的单元测试里加入这么一个用例：</p>\\n<div class=\\"language-rust\\" data-ext=\\"rs\\" data-title=\\"rs\\"><pre class=\\"language-rust\\"><code><span class=\\"token attribute attr-name\\">#[test]</span>\\n<span class=\\"token keyword\\">fn</span> <span class=\\"token function-definition function\\">it_struct_sort_ascending_equal_box</span><span class=\\"token punctuation\\">(</span><span class=\\"token punctuation\\">)</span> <span class=\\"token punctuation\\">{</span>\\n    <span class=\\"token attribute attr-name\\">#[derive(Debug, PartialEq)]</span>\\n    <span class=\\"token keyword\\">struct</span> <span class=\\"token type-definition class-name\\">Foo</span> <span class=\\"token punctuation\\">{</span>\\n        id<span class=\\"token punctuation\\">:</span> <span class=\\"token keyword\\">u32</span><span class=\\"token punctuation\\">,</span>\\n        name<span class=\\"token punctuation\\">:</span> <span class=\\"token operator\\">&amp;</span><span class=\\"token lifetime-annotation symbol\\">'static</span> <span class=\\"token keyword\\">str</span><span class=\\"token punctuation\\">,</span>\\n    <span class=\\"token punctuation\\">}</span>\\n\\n    <span class=\\"token keyword\\">let</span> <span class=\\"token keyword\\">mut</span> v <span class=\\"token operator\\">=</span> <span class=\\"token macro property\\">vec!</span><span class=\\"token punctuation\\">[</span>\\n        <span class=\\"token class-name\\">Box</span><span class=\\"token punctuation\\">::</span><span class=\\"token function\\">new</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">Foo</span> <span class=\\"token punctuation\\">{</span>\\n            id<span class=\\"token punctuation\\">:</span> <span class=\\"token number\\">22</span><span class=\\"token punctuation\\">,</span>\\n            name<span class=\\"token punctuation\\">:</span> <span class=\\"token string\\">\\"ZS\\"</span><span class=\\"token punctuation\\">,</span>\\n        <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n        <span class=\\"token class-name\\">Box</span><span class=\\"token punctuation\\">::</span><span class=\\"token function\\">new</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">Foo</span> <span class=\\"token punctuation\\">{</span>\\n            id<span class=\\"token punctuation\\">:</span> <span class=\\"token number\\">43</span><span class=\\"token punctuation\\">,</span>\\n            name<span class=\\"token punctuation\\">:</span> <span class=\\"token string\\">\\"LS\\"</span><span class=\\"token punctuation\\">,</span>\\n        <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n        <span class=\\"token class-name\\">Box</span><span class=\\"token punctuation\\">::</span><span class=\\"token function\\">new</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">Foo</span> <span class=\\"token punctuation\\">{</span>\\n            id<span class=\\"token punctuation\\">:</span> <span class=\\"token number\\">145</span><span class=\\"token punctuation\\">,</span>\\n            name<span class=\\"token punctuation\\">:</span> <span class=\\"token string\\">\\"WW\\"</span><span class=\\"token punctuation\\">,</span>\\n        <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n        <span class=\\"token class-name\\">Box</span><span class=\\"token punctuation\\">::</span><span class=\\"token function\\">new</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">Foo</span> <span class=\\"token punctuation\\">{</span>\\n            id<span class=\\"token punctuation\\">:</span> <span class=\\"token number\\">1</span><span class=\\"token punctuation\\">,</span>\\n            name<span class=\\"token punctuation\\">:</span> <span class=\\"token string\\">\\"ZL\\"</span><span class=\\"token punctuation\\">,</span>\\n        <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n        <span class=\\"token class-name\\">Box</span><span class=\\"token punctuation\\">::</span><span class=\\"token function\\">new</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">Foo</span> <span class=\\"token punctuation\\">{</span>\\n            id<span class=\\"token punctuation\\">:</span> <span class=\\"token number\\">9</span><span class=\\"token punctuation\\">,</span>\\n            name<span class=\\"token punctuation\\">:</span> <span class=\\"token string\\">\\"SQ\\"</span><span class=\\"token punctuation\\">,</span>\\n        <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n        <span class=\\"token class-name\\">Box</span><span class=\\"token punctuation\\">::</span><span class=\\"token function\\">new</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">Foo</span> <span class=\\"token punctuation\\">{</span>\\n            id<span class=\\"token punctuation\\">:</span> <span class=\\"token number\\">43</span><span class=\\"token punctuation\\">,</span>\\n            name<span class=\\"token punctuation\\">:</span> <span class=\\"token string\\">\\"LS2\\"</span><span class=\\"token punctuation\\">,</span>\\n        <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span>\\n    <span class=\\"token punctuation\\">]</span><span class=\\"token punctuation\\">;</span>\\n\\n    <span class=\\"token class-name\\">InsertionSorter</span><span class=\\"token punctuation\\">(</span><span class=\\"token operator\\">&amp;</span><span class=\\"token keyword\\">mut</span> v<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">.</span><span class=\\"token function\\">sort_by</span><span class=\\"token punctuation\\">(</span><span class=\\"token closure-params\\"><span class=\\"token closure-punctuation punctuation\\">|</span>prev<span class=\\"token punctuation\\">,</span> next<span class=\\"token closure-punctuation punctuation\\">|</span></span> prev<span class=\\"token punctuation\\">.</span>id <span class=\\"token operator\\">&lt;=</span> next<span class=\\"token punctuation\\">.</span>id<span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n    <span class=\\"token macro property\\">assert_eq!</span><span class=\\"token punctuation\\">(</span>\\n        v<span class=\\"token punctuation\\">,</span>\\n        <span class=\\"token macro property\\">vec!</span><span class=\\"token punctuation\\">[</span>\\n            <span class=\\"token class-name\\">Box</span><span class=\\"token punctuation\\">::</span><span class=\\"token function\\">new</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">Foo</span> <span class=\\"token punctuation\\">{</span>\\n                id<span class=\\"token punctuation\\">:</span> <span class=\\"token number\\">1</span><span class=\\"token punctuation\\">,</span>\\n                name<span class=\\"token punctuation\\">:</span> <span class=\\"token string\\">\\"ZL\\"</span><span class=\\"token punctuation\\">,</span>\\n            <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n            <span class=\\"token class-name\\">Box</span><span class=\\"token punctuation\\">::</span><span class=\\"token function\\">new</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">Foo</span> <span class=\\"token punctuation\\">{</span>\\n                id<span class=\\"token punctuation\\">:</span> <span class=\\"token number\\">9</span><span class=\\"token punctuation\\">,</span>\\n                name<span class=\\"token punctuation\\">:</span> <span class=\\"token string\\">\\"SQ\\"</span><span class=\\"token punctuation\\">,</span>\\n            <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n            <span class=\\"token class-name\\">Box</span><span class=\\"token punctuation\\">::</span><span class=\\"token function\\">new</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">Foo</span> <span class=\\"token punctuation\\">{</span>\\n                id<span class=\\"token punctuation\\">:</span> <span class=\\"token number\\">22</span><span class=\\"token punctuation\\">,</span>\\n                name<span class=\\"token punctuation\\">:</span> <span class=\\"token string\\">\\"ZS\\"</span><span class=\\"token punctuation\\">,</span>\\n            <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n            <span class=\\"token class-name\\">Box</span><span class=\\"token punctuation\\">::</span><span class=\\"token function\\">new</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">Foo</span> <span class=\\"token punctuation\\">{</span>\\n                id<span class=\\"token punctuation\\">:</span> <span class=\\"token number\\">43</span><span class=\\"token punctuation\\">,</span>\\n                name<span class=\\"token punctuation\\">:</span> <span class=\\"token string\\">\\"LS\\"</span><span class=\\"token punctuation\\">,</span>\\n            <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n            <span class=\\"token class-name\\">Box</span><span class=\\"token punctuation\\">::</span><span class=\\"token function\\">new</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">Foo</span> <span class=\\"token punctuation\\">{</span>\\n                id<span class=\\"token punctuation\\">:</span> <span class=\\"token number\\">43</span><span class=\\"token punctuation\\">,</span>\\n                name<span class=\\"token punctuation\\">:</span> <span class=\\"token string\\">\\"LS2\\"</span><span class=\\"token punctuation\\">,</span>\\n            <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">,</span>\\n            <span class=\\"token class-name\\">Box</span><span class=\\"token punctuation\\">::</span><span class=\\"token function\\">new</span><span class=\\"token punctuation\\">(</span><span class=\\"token class-name\\">Foo</span> <span class=\\"token punctuation\\">{</span>\\n                id<span class=\\"token punctuation\\">:</span> <span class=\\"token number\\">145</span><span class=\\"token punctuation\\">,</span>\\n                name<span class=\\"token punctuation\\">:</span> <span class=\\"token string\\">\\"WW\\"</span><span class=\\"token punctuation\\">,</span>\\n            <span class=\\"token punctuation\\">}</span><span class=\\"token punctuation\\">)</span>\\n        <span class=\\"token punctuation\\">]</span>\\n    <span class=\\"token punctuation\\">)</span><span class=\\"token punctuation\\">;</span>\\n<span class=\\"token punctuation\\">}</span>\\n</code></pre></div>","autoDesc":true}`);export{r as comp,d as data};
